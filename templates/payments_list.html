{% extends "base.html" %}
{% block content %}

<div class="d-flex justify-content-between mb-3">
  <h3>Payments Overview</h3>
</div>

<div class="mb-3">

<a href="{{ url_for('payments_list', status='pending') }}"
   class="btn btn-sm {{ 'btn-primary' if status_filter=='pending' else 'btn-outline-primary' }}">
   Pending
</a>

<a href="{{ url_for('payments_list', status='unpaid') }}"
   class="btn btn-sm {{ 'btn-primary' if status_filter=='unpaid' else 'btn-outline-primary' }}">
   Unpaid
</a>

<a href="{{ url_for('payments_list', status='partial') }}"
   class="btn btn-sm {{ 'btn-primary' if status_filter=='partial' else 'btn-outline-primary' }}">
   Partial
</a>

<a href="{{ url_for('payments_list', status='paid') }}"
   class="btn btn-sm {{ 'btn-primary' if status_filter=='paid' else 'btn-outline-primary' }}">
   Paid
</a>

</div>


<div class="table-responsive">
<table class="table table-striped table-sm align-middle">

<thead>
<tr>
<th>Date</th>
<th>Vendor</th>
<th class="text-end">Total Purchase</th>
<th class="text-end">Paid</th>
<th class="text-end">Balance</th>
<th>Status</th>
<th>Actions</th>
</tr>
</thead>

<tbody>

{% for purchase in purchases %}
<tr>

<td>{{ purchase.date }}</td>

<td>{{ purchase.vendor_name }}</td>

<td class="text-end fw-semibold">
₹ {{ "%.2f"|format(purchase.total_cost()) }}
</td>

<td class="text-end text-success">
₹ {{ "%.2f"|format(purchase.total_paid()) }}
</td>

<td class="text-end text-danger">
₹ {{ "%.2f"|format(purchase.balance_due()) }}
</td>

<td>
<span class="badge
{% if purchase.payment_status() == 'Paid' %}
bg-success
{% elif purchase.payment_status() == 'Partial' %}
bg-warning text-dark
{% else %}
bg-danger
{% endif %}
">
{{ purchase.payment_status() }}
</span>
</td>

<td>

<a href="{{ url_for('add_payment', purchase_id=purchase.id) }}"
   class="btn btn-sm btn-primary">
   Add Payment
</a>

<a href="{{ url_for('purchase_payments', purchase_id=purchase.id) }}"
   class="btn btn-sm btn-secondary">
   Details
</a>

</td>

</tr>

{% else %}
<tr>
<td colspan="7" class="text-center text-muted">
No purchases found
</td>
</tr>
{% endfor %}

</tbody>

</table>
</div>

{% endblock %}
